<nav class="navbar navbar-expand-lg navbar-dark custom-navbar">
  <div class="container-fluid">
    <!-- Logo on far left -->
    <a class="navbar-brand" href="/">
      <img src="./images/Untitled design(1).png" alt="BookSwap" class="logo-image"/>
    </a>
    
    <!-- Mobile: Chat icon and hamburger on the right -->
    <div class="mobile-nav-controls d-lg-none">
      <!-- Chat Icon (Mobile Only) -->
      <a class="nav-link chat-toggle-mobile" href="#" id="chatToggleMobile">
        <i class="bi bi-chat-dots"></i>
        <span class="chat-notification-badge" id="chatBadgeMobile" style="display: none;">0</span>
      </a>
      
      <!-- Hamburger Menu -->
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbarNav" data-bs-target="#navbarNav"
        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
    
    <div class="collapse navbar-collapse" id="navbarNav">
      <!-- Navigation options (shown in dropdown on mobile, center on desktop) -->
      <ul class="navbar-nav mx-auto">
        <li class="nav-item <%= activePage === 'dashboard' ? 'active' : '' %>" data-page="dashboard">
          <a class="nav-link" href="/dashboard"><i class="bi bi-speedometer2"></i> Dashboard</a>
        </li>
        <li class="nav-item <%= activePage === 'swap-matcher' ? 'active' : '' %>" data-page="swap-matcher">
          <a class="nav-link" href="/swap-matcher"><i class="bi bi-arrow-left-right"></i> Swap Matcher</a>
        </li>
        <li class="nav-item <%= activePage === 'library' ? 'active' : '' %>" data-page="library">
          <a class="nav-link" href="/library"><i class="bi bi-book"></i> My Library</a>
        </li>
        <li class="nav-item <%= activePage === 'wishlist' ? 'active' : '' %>" data-page="wishlist">
          <a class="nav-link" href="/wishlist"><i class="bi bi-heart"></i> Wishlist</a>
        </li>
        <li class="nav-item <%= activePage === 'rewards' ? 'active' : '' %>" data-page="rewards">
          <a class="nav-link" href="/rewards"><i class="bi bi-trophy"></i> Rewards</a>
        </li>
        
        <!-- Profile dropdown (shown in mobile menu) -->
        <li class="nav-item dropdown d-lg-none">
          <a class="nav-link dropdown-toggle" href="#" id="profileDropdownMobile" role="button"
            data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <i class="bi bi-person-circle"></i> Profile
          </a>
          <div class="dropdown-menu" aria-labelledby="profileDropdownMobile">
            <a class="dropdown-item" href="/me"><i class="bi bi-person"></i> My Profile</a>
            <a class="dropdown-item" href="/history"><i class="bi bi-clock-history"></i> Activity History</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="/logout"><i class="bi bi-box-arrow-right"></i> Logout</a>
          </div>
        </li>
      </ul>

      <!-- Desktop: Chat icon and Profile on the right -->
      <ul class="navbar-nav ml-auto d-none d-lg-flex">
        <!-- Chat Icon (Desktop Only) -->
        <li class="nav-item">
          <a class="nav-link chat-toggle" href="#" id="chatToggle">
            <i class="bi bi-chat-dots"></i>
            <span class="chat-notification-badge" id="chatBadge" style="display: none;">0</span>
          </a>
        </li>
        
        <!-- Profile Dropdown (Desktop Only) -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="profileDropdown" role="button"
            data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <i class="bi bi-person-circle"></i> Profile
          </a>
          <div class="dropdown-menu dropdown-menu-right" aria-labelledby="profileDropdown">
            <a class="dropdown-item" href="/me"><i class="bi bi-person"></i> My Profile</a>
            <a class="dropdown-item" href="/history"><i class="bi bi-clock-history"></i> Activity History</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="/logout"><i class="bi bi-box-arrow-right"></i> Logout</a>
          </div>
        </li>
      </ul>
    </div>
  </div>
</nav>

<!-- Include Chat Modal -->
<%- include('chat-modal') %>

<!-- Mobile Navigation Script -->
<script src="/js/mobile-nav.js"></script>